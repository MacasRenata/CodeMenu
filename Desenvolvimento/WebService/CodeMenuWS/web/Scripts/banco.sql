/* 
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
/**
 * Author:  Cristian
 * Created: 08/10/2017
 */
drop database codemenu;
CREATE DATABASE codemenu;
USE codemenu;

drop table estabelecimentos;
CREATE TABLE estabelecimentos (
id INT AUTO_INCREMENT NOT NULL,
nome VARCHAR(200) NOT NULL, 
telefone VARCHAR(20) NOT NULL, 
email VARCHAR(255) NOT NULL, 
endereco TEXT NOT NULL,
PRIMARY KEY (id)
);

drop table mesa;
CREATE TABLE mesa (
id INT AUTO_INCREMENT NOT NULL,
identificacao VARCHAR(20) NOT NULL,  
qrcode VARCHAR(200) NOT NULL,  
estabelecimento_id INTEGER NOT NULL,
PRIMARY KEY (id)
);

drop table cliente;
CREATE TABLE cliente (
id INT AUTO_INCREMENT NOT NULL,
telefone VARCHAR(20) NOT NULL, 
PRIMARY KEY (id)
);

drop table  item;
CREATE TABLE item (
id INT AUTO_INCREMENT NOT NULL,
nome VARCHAR(200) NOT NULL, 
tipo INT NOT NULL,
preco DECIMAL(10,2),
imagem BLOB,  
estabelecimento_id INTEGER NOT NULL,
PRIMARY KEY (id)
);

drop table pedidos;
CREATE TABLE pedidos (
id INT AUTO_INCREMENT NOT NULL,
hora DATETIME NOT NULL, 
status INT,
valor DECIMAL(10,2),
quantidade INT NOT NULL,
cliente_id INTEGER NOT NULL,
mesa_id INTEGER NOT NULL,
item_id INTEGER NOT NULL, 
comanda_id INTEGER NOT NULL, 
PRIMARY KEY (id)
);

drop table comanda;
CREATE TABLE comanda (
id INT AUTO_INCREMENT NOT NULL,
hora DATETIME NOT NULL, 
status INT,
valor_total DECIMAL(10,2),
PRIMARY KEY (id)
);

ALTER TABLE mesa ADD CONSTRAINT mesa_estabelecimento_fk FOREIGN KEY (estabelecimento_id)REFERENCES estabelecimentos(id);
ALTER TABLE item ADD CONSTRAINT item_estabelecimento_fk FOREIGN KEY (estabelecimento_id)REFERENCES estabelecimentos(id);
ALTER TABLE pedidos ADD CONSTRAINT pedido_cliente_fk FOREIGN KEY (cliente_id)REFERENCES cliente(id);
ALTER TABLE pedidos ADD CONSTRAINT pedido_mesa_fk FOREIGN KEY (mesa_id)REFERENCES mesa(id);
ALTER TABLE pedidos ADD CONSTRAINT pedido_item_fk FOREIGN KEY (item_id)REFERENCES item(id);
ALTER TABLE pedidos ADD CONSTRAINT pedido_comanda_fk FOREIGN KEY (comanda_id)REFERENCES comanda(id);


-- INSERIR DADOS NA TABELA ESTABELECIMENTOS
-- RESTAURANTE CÓDIGO 1
INSERT INTO ESTABELECIMENTOS(NOME,TELEFONE,EMAIL,ENDERECO) 
VALUES 
('RESTAURANTE SHOW','5132503344','RESTAURANTESHOW@GMAIL.COM','AV. JOAO ANTONIO DA SILVEIRA, N.º 499, RESTINGA, PORTO ALEGRE, RS');

-- RESTAURANTE CÓDIGO 2 
INSERT INTO ESTABELECIMENTOS(ID,NOME,TELEFONE,EMAIL,ENDERECO) 
VALUES 
(NULL, 'RESTAURANTE COMEBEM','5133362122','COMEBEM@GMAIL.COM','AV. AZENHA, N.º 1234, AZENHA, PORTO ALEGRE, RS');


-- INSERIR DADOS NA TABELA MESA - RESTAURANTE 1
-- MESA 1
INSERT INTO MESA (ID, IDENTIFICACAO, QRCODE, ESTABELECIMENTO_ID)
VALUES (1, 'MESA 01','QRCODE01',1);
-- MESA 2
INSERT INTO MESA (ID, IDENTIFICACAO, QRCODE, ESTABELECIMENTO_ID)
VALUES (NULL, 'MESA 02','QRCODE02',1);
-- MESA 3
INSERT INTO MESA (ID, IDENTIFICACAO, QRCODE, ESTABELECIMENTO_ID)
VALUES (NULL, 'MESA 03','QRCODE03',1);
-- MESA 4
INSERT INTO MESA (ID, IDENTIFICACAO, QRCODE, ESTABELECIMENTO_ID)
VALUES (NULL, 'MESA 04','QRCODE04',1);
-- MESA 5
INSERT INTO MESA (ID, IDENTIFICACAO, QRCODE, ESTABELECIMENTO_ID)
VALUES (5, 'MESA 05','QRCODE05',1);

-- INSERIR DADOS NA TABELA CLIENTE
-- CLIENTE 01 CRISTIAN
INSERT INTO CLIENTE(ID, TELEFONE)
VALUES
(NULL, '519993610100');

-- CLIENTE 02  MARCIO
INSERT INTO CLIENTE(ID, TELEFONE)
VALUES
(NULL, '51984827932');

-- CLIENTE 03 RENATA
INSERT INTO CLIENTE(ID, TELEFONE)
VALUES
(NULL, '51982495973');

-- INSERIR DADOS NA TABELA ITEM: 1 = COMIDA e 2 = BEBIDA
INSERT INTO ITEM
(ID, NOME, TIPO, PRECO, IMAGEM,estabelecimento_id) 
VALUES
(NULL, 'COCA COLA LATA', 2, 3.50, '',1);

INSERT INTO ITEM
(ID, NOME, TIPO, PRECO, IMAGEM,estabelecimento_id) 
VALUES
(NULL, 'AGUA MINERAL COM GAS', 2, 2.50, '',1);

INSERT INTO ITEM
(ID, NOME, TIPO, PRECO, IMAGEM,estabelecimento_id) 
VALUES
(NULL, 'FANTA LARANJA LATA', 2, 3.50, '',1);

INSERT INTO ITEM
(ID, NOME, TIPO, PRECO, IMAGEM,estabelecimento_id) 
VALUES
(NULL, 'SPRITE LATA', 2, 3.50, '',1);

INSERT INTO ITEM
(ID, NOME, TIPO, PRECO, IMAGEM,estabelecimento_id) 
VALUES
(NULL, 'PEPSI LATA', 2, 3.50, '',1);

INSERT INTO ITEM
(ID, NOME, TIPO, PRECO, IMAGEM,estabelecimento_id) 
VALUES
(NULL, 'CERVEJA BRAHMA LATA', 2, 6.50, '',1);

INSERT INTO ITEM
(ID, NOME, TIPO, PRECO, IMAGEM,estabelecimento_id) 
VALUES
(NULL, 'CERVEJA SKOL LATA', 2, 6.50, '',1);

INSERT INTO ITEM
(ID, NOME, TIPO, PRECO, IMAGEM,estabelecimento_id) 
VALUES
(NULL, 'PIZZA CALABRESA', 1, 35.50, '',1);

INSERT INTO ITEM
(ID, NOME, TIPO, PRECO, IMAGEM,estabelecimento_id) 
VALUES
(NULL, 'PIZZA 4 QUEIJOS', 1, 35.50, '',1);

INSERT INTO ITEM
(ID, NOME, TIPO, PRECO, IMAGEM,estabelecimento_id) 
VALUES
(NULL, 'XIS CORAÇÃO', 1, 12.50, '',1);

INSERT INTO ITEM
(ID, NOME, TIPO, PRECO, IMAGEM,estabelecimento_id) 
VALUES
(NULL, 'XIS CALABRESA', 1, 14.50, '',1);

UPDATE MESA SET QRCODE = 'QRCODE01' WHERE ID = 1;
UPDATE MESA SET QRCODE = 'QRCODE02' WHERE ID = 2;
UPDATE MESA SET QRCODE = 'QRCODE03' WHERE ID = 3;
UPDATE MESA SET QRCODE = 'QRCODE04' WHERE ID = 4;
UPDATE MESA SET QRCODE = 'QRCODE05' WHERE ID = 5;


